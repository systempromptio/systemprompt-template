# Feature: The Closed Loop
# Execute. Log. Analyze. Adapt. Production-ready self-improvement.

slug: "closed-loop-agents"
title: "AI Agent Analytics | Audit Trails & Behavior Tracking"
headline: "AGENTS THAT LEARN"
headline_highlight: "FROM THEIR OWN METRICS"
subtitle: "Every action logged. Every metric queryable. Your agents can inspect their own performance—error rates, costs, latency—and adapt in real-time."
icon: "refresh-cw"
description: "MCP tool calls logged to PostgreSQL, A2A self-analysis in real-time, behavioral pattern recognition, dynamic context and skill modification, production audit trail with trace IDs."

highlights:
  - text: "Every action logged to PostgreSQL"
    id: "action-logging"
  - text: "Agents query their own performance"
    id: "self-analysis"
  - text: "Behavioral pattern recognition"
    id: "engagement-intelligence"
  - text: "Live configuration updates"
    id: "real-time-modification"
  - text: "End-to-end session tracing"
    id: "audit-trail"

cta:
  text: "Get Started"
  url: "https://github.com/systempromptio/systemprompt-template"
  secondary_text: "Documentation"
  secondary_url: "/documentation"

sections:
  - id: "action-logging"
    title: "MCP Calls → PostgreSQL → CLI Queries"
    content: "Agent calls an MCP tool? Logged. Tool name, execution time, result status, trace ID. User visits a page? Captured. Session ID, reading pattern, scroll depth, rage clicks. Everything goes to PostgreSQL. Query it with SQL. Export it anywhere. Your data, your database."
    items:
      - title: "MCP Tool Logging"
        description: "Every mcp.tool_call records: tool name, execution duration, status, request/response payloads. Query with: systemprompt infra logs --type mcp.tool_call"
        icon: "database"
      - title: "A2A Invocation Tracking"
        description: "Agent-to-agent calls logged with caller, callee, context_id, task_id. Trace multi-agent workflows end-to-end across your agentic mesh."
        icon: "git-merge"
      - title: "Engagement Events"
        description: "Page views, scroll depth (25/50/75/90/100%), time_on_page_ms, visible_time_ms, hidden_time_ms. Structured events in PostgreSQL, not third-party analytics."
        icon: "activity"
    visual_desktop: "/files/images/features/closed-loop-agents/action-logging-desktop.svg"
    visual_mobile: "/files/images/features/closed-loop-agents/action-logging-mobile.svg"
    visual_position: "right"

  - id: "self-analysis"
    title: "Self-Aware Agents"
    content: "Your agents can query their own performance data. Run systemprompt analytics agents stats. Success rate dropping? The agent sees it. Response times climbing? It knows. Cost per request spiking? It can react. The feedback loop is built into the protocol."
    items:
      - title: "Analytics as MCP Tools"
        description: "Run systemprompt analytics agents stats or systemprompt analytics costs breakdown --by-agent. These commands are also available as agent-callable tools."
        icon: "bar-chart-2"
      - title: "Performance Introspection"
        description: "Agents query their own metrics: token usage per request, latency percentiles, error rates, cost trends. Self-awareness built into the protocol."
        icon: "eye"
      - title: "Adaptive Behavior"
        description: "Based on analytics, agents can switch skills, modify context, or invoke other agents via A2A. Real-time adaptation without human intervention."
        icon: "zap"
    visual_desktop: "/files/images/features/closed-loop-agents/self-analysis-desktop.svg"
    visual_mobile: "/files/images/features/closed-loop-agents/self-analysis-mobile.svg"
    visual_position: "left"

  - id: "engagement-intelligence"
    title: "Beyond Pageviews"
    content: "Not just pageviews. The engagement tracker classifies actual reading behavior: bounce, skimmer, scanner, reader, engaged. It detects rage clicks (3+ in 500ms) and dead clicks on non-interactive elements. Real signals, not vanity metrics."
    items:
      - title: "Reading Pattern Classification"
        description: "Automatic user segmentation: bounce, skimmer, scanner, reader, engaged. Stored per session. Query patterns across your user base."
        icon: "book-open"
      - title: "Interaction Signals"
        description: "Rage clicks (3+ in 500ms), dead clicks on non-interactive elements, scroll velocity, direction changes, copy events. Behavioral signals beyond basic analytics."
        icon: "mouse-pointer"
      - title: "Session Intelligence"
        description: "time_to_first_interaction_ms, time_to_first_scroll_ms, visible vs hidden time, device type, country. Full session context for debugging and analysis."
        icon: "clock"
    visual_desktop: "/files/images/features/closed-loop-agents/engagement-intelligence-desktop.svg"
    visual_mobile: "/files/images/features/closed-loop-agents/engagement-intelligence-mobile.svg"
    visual_position: "right"

  - id: "real-time-modification"
    title: "The Loop Closes"
    content: "The loop closes when insights change agent behavior. Contexts persist in PostgreSQL and are shared across agents. Skills can be added via CLI. System prompts can be updated without redeployment. The system evolves."
    items:
      - title: "Shared Contexts"
        description: "Multi-agent contexts stored in PostgreSQL, accessible via systemprompt core contexts. Agents share state, see each other's work, build on previous conversations."
        icon: "layers"
      - title: "Dynamic Skills"
        description: "Add or remove skills at runtime: systemprompt admin agents edit assistant --skill new_skill. No rebuild required. Agents discover new capabilities immediately."
        icon: "plus-circle"
      - title: "Live Configuration"
        description: "Update system prompts, enable/disable agents, modify OAuth scopes. All via CLI. Changes take effect immediately. Zero-downtime adaptation."
        icon: "settings"
    visual_desktop: "/files/images/features/closed-loop-agents/real-time-modification-desktop.svg"
    visual_mobile: "/files/images/features/closed-loop-agents/real-time-modification-mobile.svg"
    visual_position: "left"

  - id: "audit-trail"
    title: "Debug Any Request"
    content: "Every request has a trace ID. Every tool call is linked. When something goes wrong, run systemprompt infra logs --trace abc123. From user click to agent response to tool execution. End-to-end visibility in one query."
    items:
      - title: "End-to-End Tracing"
        description: "Each request gets a trace_id. Follow it through MCP calls, A2A invocations, and database operations. One ID ties everything together."
        icon: "link"
      - title: "Compliance Ready"
        description: "SOC 2, GDPR, HIPAA audit exports. Generate compliance reports directly from PostgreSQL. No third-party audit tools required."
        icon: "shield"
      - title: "Debug Any Issue"
        description: "Filter by user, agent, time range, error status. Reproduce any session. Find the needle in the haystack instantly."
        icon: "search"
    visual_desktop: "/files/images/features/closed-loop-agents/audit-trail-desktop.svg"
    visual_mobile: "/files/images/features/closed-loop-agents/audit-trail-mobile.svg"
    visual_position: "right"

related:
  - title: "Self-Hosted AI Platform"
    description: "Complete AI infrastructure in one binary. Deploy anywhere."
    url: "/features/self-hosted-ai-platform"
  - title: "Unified Control Plane"
    description: "One CLI to manage everything. The same interface superagents use."
    url: "/features/unified-control-plane"
  - title: "Analytics Playbook"
    description: "Step-by-step guide to querying metrics and costs."
    url: "/playbooks?id=cli_analytics"
  - title: "Playbook: Analytics"
    description: "Step-by-step guide to querying metrics and costs."
    url: "/playbooks?id=cli_analytics"
