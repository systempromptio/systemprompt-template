<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  {{{HEAD_ASSETS}}}
  <title>{{BLOG_NAME}} | {{ORG_NAME}}</title>
  <meta name="description" content="{{BLOG_DESCRIPTION}}" />
  <meta name="keywords" content="{{BLOG_KEYWORDS}}" />
  <link rel="canonical" href="{{BLOG_URL}}" />
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="stylesheet" href="/css/blog.css" />
  <link rel="stylesheet" href="/css/content-cards.css" />

  <!-- Open Graph -->
  <meta property="og:title" content="{{BLOG_NAME}} | {{ORG_NAME}}" />
  <meta property="og:description" content="{{BLOG_DESCRIPTION}}" />
  <meta property="og:image" content="{{BLOG_IMAGE}}" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="{{BLOG_URL}}" />
  <meta property="og:site_name" content="{{ORG_NAME}}" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="{{TWITTER_HANDLE}}" />
  <meta name="twitter:title" content="{{BLOG_NAME}} | {{ORG_NAME}}" />
  <meta name="twitter:description" content="{{BLOG_DESCRIPTION}}" />
  <meta name="twitter:image" content="{{BLOG_IMAGE}}" />

  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Blog",
    "name": "{{BLOG_NAME}}",
    "description": "{{BLOG_DESCRIPTION}}",
    "url": "{{BLOG_URL}}",
    "image": "{{BLOG_IMAGE}}",
    "publisher": {
      "@type": "Organization",
      "name": "{{ORG_NAME}}",
      "logo": {
        "@type": "ImageObject",
        "url": "{{ORG_LOGO}}"
      }
    },
    "inLanguage": "{{BLOG_LANGUAGE}}"
  }
  </script>
</head>
<body>
  <div class="blog-background"></div>
  <div class="blog-shape-left"></div>

  {{{HEADER}}}

  <main class="blog-list">
    <header class="content-list-header">
      <div class="content-list-header__icon content-list-header__icon--blog"></div>
      <h1>{{BLOG_NAME}}</h1>
      <p class="subtitle">{{BLOG_DESCRIPTION}}</p>
    </header>

    <div class="blog-controls">
      <div class="blog-filters">
        <button class="blog-filter-btn active" data-filter="all">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/>
            <rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/>
          </svg>
          All
        </button>
        <button class="blog-filter-btn" data-filter="announcement">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
            <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
          </svg>
          Announcement
        </button>
        <button class="blog-filter-btn" data-filter="blog">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
          </svg>
          Blog
        </button>
        <button class="blog-filter-btn" data-filter="guide">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
          </svg>
          Guide
        </button>
      </div>
      <div class="blog-sort">
        <label class="blog-sort-label" for="blog-sort">Sort:</label>
        <select id="blog-sort" class="blog-sort-select">
          <option value="date-desc">Newest First</option>
          <option value="date-asc">Oldest First</option>
          <option value="title-asc">Title A-Z</option>
          <option value="title-desc">Title Z-A</option>
        </select>
      </div>
    </div>

    <div class="blog-grid posts" id="blog-grid">
      {{{POSTS}}}
    </div>
  </main>

  <script>
  (function() {
    const grid = document.getElementById('blog-grid');
    const filterBtns = document.querySelectorAll('.blog-filter-btn');
    const sortSelect = document.getElementById('blog-sort');

    // Apply filter from URL or button
    function applyFilter(filter) {
      filterBtns.forEach(b => b.classList.remove('active'));
      const activeBtn = document.querySelector(`.blog-filter-btn[data-filter="${filter || 'all'}"]`);
      if (activeBtn) activeBtn.classList.add('active');
      grid.dataset.filter = filter || '';

      // Update URL without reload
      const url = new URL(window.location);
      if (filter && filter !== 'all') {
        url.searchParams.set('category', filter);
      } else {
        url.searchParams.delete('category');
      }
      window.history.replaceState({}, '', url);
    }

    // Check URL for initial filter
    const urlParams = new URLSearchParams(window.location.search);
    const initialFilter = urlParams.get('category');
    if (initialFilter) {
      applyFilter(initialFilter);
    }

    // Filter button clicks
    filterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const filter = btn.dataset.filter;
        applyFilter(filter === 'all' ? '' : filter);
      });
    });

    // Sort functionality
    sortSelect.addEventListener('change', () => {
      const cards = Array.from(grid.querySelectorAll('a.content-card-link, a.blog-card-link'));
      const sortValue = sortSelect.value;

      cards.sort((a, b) => {
        const titleA = a.querySelector('.card-title')?.textContent?.toLowerCase() || '';
        const titleB = b.querySelector('.card-title')?.textContent?.toLowerCase() || '';
        const dateA = a.querySelector('.card-date, .meta-date')?.textContent || '';
        const dateB = b.querySelector('.card-date, .meta-date')?.textContent || '';

        switch(sortValue) {
          case 'title-asc':
            return titleA.localeCompare(titleB);
          case 'title-desc':
            return titleB.localeCompare(titleA);
          case 'date-desc':
            return new Date(dateB) - new Date(dateA);
          case 'date-asc':
            return new Date(dateA) - new Date(dateB);
          default:
            return 0;
        }
      });

      cards.forEach(card => grid.appendChild(card));
    });
  })();
  </script>

  {{{FOOTER}}}

  {{{SCRIPTS}}}
</body>
</html>
