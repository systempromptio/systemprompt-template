<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Resource Hints -->
<link rel="preconnect" href="/files/fonts/" crossorigin>
<link rel="dns-prefetch" href="/files/fonts/">

<!-- Font Preloading - Critical fonts loaded early -->
<link rel="preload" as="font" href="/files/fonts/Zepto/Zepto.woff" type="font/woff" crossorigin>
<link rel="preload" as="font" href="/files/fonts/OpenSans/OpenSans-Regular.ttf" type="font/truetype" crossorigin>

<!-- Critical CSS - Inlined to prevent FOUC -->
<style>
/* Prevent flash of unstyled content */
:root {
  --color-bg: #0a0a0f;
  --color-surface: #12121a;
  --color-text: #e8e8ed;
  --color-text-secondary: #9898a6;
  --orange-500: #f97316;
  --orange-600: #ea580c;
}
html {
  background-color: var(--color-bg);
  color: var(--color-text);
}
body {
  margin: 0;
  font-family: "OpenSans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  background-color: var(--color-bg);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* Hide content until styles load to prevent layout shift */
.header, .site-header {
  min-height: 64px;
}
/* Font-face for immediate availability */
@font-face {
  font-family: "Zepto";
  src: url("/files/fonts/Zepto/Zepto.woff") format("woff");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: "OpenSans";
  src: url("/files/fonts/OpenSans/OpenSans-Regular.ttf") format("truetype");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}
</style>

<!-- Core Styles -->
<link rel="stylesheet" href="/css/core/variables.css">
<link rel="stylesheet" href="/css/core/fonts.css">
<link rel="stylesheet" href="/css/core/reset.css">
<link rel="stylesheet" href="/css/components/header.css">
<link rel="stylesheet" href="/css/components/footer.css">
<link rel="stylesheet" href="/css/components/mobile-menu.css">


  <!-- SEO Meta Tags -->
  <title>Authentication | systemprompt.io Documentation</title>
  <meta name="description" content="OAuth2/OIDC and WebAuthn authentication built in. Ship AI products with enterprise-grade security from day one." />
  <meta name="author" content="SystemPrompt Team" />
  <meta name="keywords" content="authentication, oauth2, oidc, webauthn, security, tokens" />
  <link rel="canonical" href="https://systemprompt.io/documentation/services/auth" />

  <!-- Open Graph -->
  <meta property="og:title" content="Authentication" />
  <meta property="og:description" content="OAuth2/OIDC and WebAuthn authentication built in. Ship AI products with enterprise-grade security from day one." />
  <meta property="og:image" content="/files/images/docs/services-auth.svg" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://systemprompt.io/documentation/services/auth" />
  <meta property="og:site_name" content="systemprompt.io" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@your_handle" />
  <meta name="twitter:creator" content="@your_handle" />
  <meta name="twitter:title" content="Authentication" />
  <meta name="twitter:description" content="OAuth2/OIDC and WebAuthn authentication built in. Ship AI products with enterprise-grade security from day one." />
  <meta name="twitter:image" content="/files/images/docs/services-auth.svg" />

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />

  <!-- Styles -->
  <link rel="stylesheet" href="/css/docs.css" />
  <link rel="stylesheet" href="/css/syntax-highlight.css" />

  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "TechArticle",
    "headline": "Authentication",
    "description": "OAuth2/OIDC and WebAuthn authentication built in. Ship AI products with enterprise-grade security from day one.",
    "image": "/files/images/docs/services-auth.svg",
    "author": {
      "@type": "Organization",
      "name": "systemprompt.io"
    },
    "publisher": {
      "@type": "Organization",
      "name": "systemprompt.io",
      "logo": {
        "@type": "ImageObject",
        "url": "https://systemprompt.io/files/images/logo.png"
      }
    },
    "datePublished": "",
    "dateModified": "",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://systemprompt.io/documentation/services/auth"
    },
    "keywords": "authentication, oauth2, oidc, webauthn, security, tokens",
    "inLanguage": ""
  }
  </script>

  <!-- BreadcrumbList Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {"@type": "ListItem", "position": 1, "name": "Home", "item": "https://systemprompt.io"},
      {"@type": "ListItem", "position": 2, "name": "Documentation", "item": "https://systemprompt.io/documentation"},
      {"@type": "ListItem", "position": 3, "name": "Authentication", "item": "https://systemprompt.io/documentation/services/auth"}
    ]
  }
  </script>
</head>
<body class="docs-body">
  <div class="docs-background"></div>

  <header class="site-header">
  <nav class="site-nav">
    <a href="/" class="logo-link">
      <img src="/files/images/logo.svg" alt="systemprompt.io" class="logo-svg" />
    </a>
    <button class="mobile-menu-toggle" aria-label="Toggle navigation" aria-expanded="false">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    <div class="nav-links">
      <div class="nav-dropdown">
        <a href="/documentation" class="nav-dropdown-trigger">
          Documentation
          <svg class="dropdown-arrow" viewBox="0 0 12 12" width="12" height="12">
            <path d="M2 4l4 4 4-4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </a>
        <div class="nav-dropdown-menu">
          <div class="dropdown-section">
            <h4>Getting Started</h4>
            <a href="/documentation">Overview</a>
            <a href="/documentation/installation">Installation</a>
            <a href="/documentation/playbooks">Playbooks</a>
          </div>
          <div class="dropdown-section">
            <h4>Configuration</h4>
            <a href="/documentation/config">Config</a>
            <a href="/documentation/services">Services</a>
            <a href="/documentation/extensions">Extensions</a>
          </div>
          <a href="/documentation" class="dropdown-view-all">View all documentation &rarr;</a>
        </div>
      </div>
      <div class="nav-dropdown">
        <a href="/blog" class="nav-dropdown-trigger">
          Blog
          <svg class="dropdown-arrow" viewBox="0 0 12 12" width="12" height="12">
            <path d="M2 4l4 4 4-4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </a>
        <div class="nav-dropdown-menu">
          <div class="dropdown-section">
            <h4>Categories</h4>
            <a href="/blog">All Posts</a>
            <a href="/blog?category&#x3D;announcement">Announcements</a>
            <a href="/blog?category&#x3D;article">Articles</a>
            <a href="/blog?category&#x3D;guide">Guides</a>
          </div>
        </div>
      </div>
      <div class="nav-dropdown">
        <a href="https://systemprompt.io/playbooks" class="nav-dropdown-trigger">
          Playbooks
          <svg class="dropdown-arrow" viewBox="0 0 12 12" width="12" height="12">
            <path d="M2 4l4 4 4-4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </a>
        <div class="nav-dropdown-menu">
          <div class="dropdown-section">
            <h4>Categories</h4>
            <a href="https://systemprompt.io/playbooks">All Playbooks</a>
            <a href="https://systemprompt.io/playbooks?category&#x3D;guide">Guides</a>
            <a href="https://systemprompt.io/playbooks?category&#x3D;cli">CLI</a>
            <a href="https://systemprompt.io/playbooks?category&#x3D;build">Build</a>
            <a href="https://systemprompt.io/playbooks?category&#x3D;content">Content</a>
          </div>
        </div>
      </div>
      <a href="/documentation/installation" class="cta-button">Get Started</a>
    </div>
  </nav>
</header>


  <div class="docs-layout">
    <!-- Left Sidebar - Navigation (dynamically rendered from config.yaml) -->
    <aside class="docs-sidebar">
      <nav class="docs-nav" aria-label="Documentation navigation">
        <div class="docs-nav-section">
          <h3 class="docs-nav-title">Getting Started</h3>
          <ul class="docs-nav-list">
            <li><a href="/documentation" class="docs-nav-link">Overview</a></li>
            <li><a href="/documentation/installation" class="docs-nav-link">Installation</a></li>
            <li><a href="/documentation/licensing" class="docs-nav-link">Licensing</a></li>
            <li><a href="/documentation/playbooks" class="docs-nav-link">Playbooks</a></li>
          </ul>
        </div>
        <div class="docs-nav-section">
          <h3 class="docs-nav-title">Config</h3>
          <ul class="docs-nav-list">
            <li><a href="/documentation/config" class="docs-nav-link">Overview</a></li>
            <li><a href="/documentation/config/database" class="docs-nav-link">Database</a></li>
            <li><a href="/documentation/config/deployment" class="docs-nav-link">Deployment</a></li>
            <li><a href="/documentation/config/docker" class="docs-nav-link">Docker</a></li>
            <li><a href="/documentation/config/domains" class="docs-nav-link">Domains</a></li>
            <li><a href="/documentation/config/profiles" class="docs-nav-link">Profiles</a></li>
            <li><a href="/documentation/config/secrets" class="docs-nav-link">Secrets</a></li>
            <li><a href="/documentation/config/sessions" class="docs-nav-link">Sessions</a></li>
            <li><a href="/documentation/config/sync" class="docs-nav-link">Sync</a></li>
            <li><a href="/documentation/config/tenants" class="docs-nav-link">Tenants</a></li>
          </ul>
        </div>
        <div class="docs-nav-section">
          <h3 class="docs-nav-title">Services</h3>
          <ul class="docs-nav-list">
            <li><a href="/documentation/services" class="docs-nav-link">Overview</a></li>
            <li><a href="/documentation/services/agents" class="docs-nav-link">Agents</a></li>
            <li><a href="/documentation/services/ai" class="docs-nav-link">AI</a></li>
            <li><a href="/documentation/services/analytics" class="docs-nav-link">Analytics</a></li>
            <li><a href="/documentation/services/auth" class="docs-nav-link">Auth</a></li>
            <li><a href="/documentation/services/config" class="docs-nav-link">Config</a></li>
            <li><a href="/documentation/services/content" class="docs-nav-link">Content</a></li>
            <li><a href="/documentation/services/files" class="docs-nav-link">Files</a></li>
            <li><a href="/documentation/services/mcp" class="docs-nav-link">MCP</a></li>
            <li><a href="/documentation/services/playbooks" class="docs-nav-link">Playbooks</a></li>
            <li><a href="/documentation/services/scheduler" class="docs-nav-link">Scheduler</a></li>
            <li><a href="/documentation/services/skills" class="docs-nav-link">Skills</a></li>
            <li><a href="/documentation/services/users" class="docs-nav-link">Users</a></li>
            <li><a href="/documentation/services/web" class="docs-nav-link">Web</a></li>
            <li><a href="/documentation/services/workflows" class="docs-nav-link">Workflows</a></li>
          </ul>
        </div>
        <div class="docs-nav-section">
          <h3 class="docs-nav-title">Extensions</h3>
          <ul class="docs-nav-list">
            <li><a href="/documentation/extensions" class="docs-nav-link">Overview</a></li>
            <li><a href="/documentation/extensions/template" class="docs-nav-link">Template Architecture</a></li>
            <li><a href="/documentation/extensions/hooks" class="docs-nav-link">Lifecycle Hooks</a></li>
            <li><a href="/documentation/extensions/rust" class="docs-nav-link">Library Extensions</a></li>
            <li><a href="/documentation/extensions/web" class="docs-nav-link">Web Extensions</a></li>
            <li><a href="/documentation/extensions/page-data-providers" class="docs-nav-link">Page Data Providers</a></li>
            <li><a href="/documentation/extensions/component-renderers" class="docs-nav-link">Component Renderers</a></li>
            <li><a href="/documentation/extensions/jobs" class="docs-nav-link">Background Jobs</a></li>
            <li><a href="/documentation/extensions/mcp" class="docs-nav-link">MCP Extensions</a></li>
            <li><a href="/documentation/extensions/cli" class="docs-nav-link">CLI Extensions</a></li>
          </ul>
        </div>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="docs-main">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="/">Home</a>
        <span class="breadcrumb__separator">/</span>
        <a href="/documentation">Documentation</a>
        <span class="breadcrumb__separator">/</span>
        <span class="breadcrumb__current">Authentication</span>
      </nav>

      <article class="docs-article">
        <header class="docs-header">
          <div class="docs-title-row">
            <h1>Authentication</h1>
            <button class="docs-export-btn" data-slug="services/auth" aria-label="Copy as Markdown" title="Copy as Markdown">
              <svg class="copy-icon" viewBox="0 0 16 16" width="16" height="16" fill="currentColor">
                <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"/>
                <path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"/>
              </svg>
              <svg class="check-icon" viewBox="0 0 16 16" width="16" height="16" fill="currentColor">
                <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.75.75 0 1 1 1.06-1.06L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"/>
              </svg>
            </button>
          </div>
          <p class="docs-description">OAuth2/OIDC and WebAuthn authentication built in. Ship AI products with enterprise-grade security from day one.</p>
          <div class="docs-meta">
            <time datetime="">Last updated: </time>
          </div>
        </header>

        <!-- Learning Objectives - Top Callout -->

        <!-- Mobile Table of Contents (shown â‰¤1200px) -->
        <div class="docs-toc-mobile">
          <details class="toc-mobile-details">
            <summary class="toc-mobile-summary">
              <span class="toc-mobile-label">On this page</span>
              <svg class="toc-mobile-chevron" viewBox="0 0 12 12" width="12" height="12" fill="none" stroke="currentColor">
                <path d="M2 4l4 4 4-4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </summary>
            <nav class="toc-mobile-nav" aria-label="Table of contents">
              <div class="toc-content toc-content--mobile">
                <ul class="toc-list">
<li class="toc-item toc-level-2">
<a class="toc-link" href="#authentication-architecture">Authentication Architecture</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#oauth2-authorization-flows">OAuth2 Authorization Flows</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#webauthn-passwordless-authentication">WebAuthn Passwordless Authentication</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#scopes-for-fine-grained-access-control">Scopes for Fine-Grained Access Control</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#configuration">Configuration</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#cli-authentication-commands">CLI Authentication Commands</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#cli-reference">CLI Reference</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#security-considerations">Security Considerations</a>
</li>
</ul>

              </div>


            </nav>
          </details>
        </div>

        <div class="docs-content">
          <p>SystemPrompt includes a complete authentication system that handles both API access and user login. OAuth2 with OpenID Connect secures API calls and MCP tool execution. WebAuthn provides passwordless authentication for web interfaces. Every authentication event is logged for audit compliance.</p>
<p>The authentication system is not optional or bolted on. It's woven into every layer of the platform. When you connect Claude Desktop to a SystemPrompt MCP server, OAuth2 handles the authorization. When a user logs into your AI product, WebAuthn eliminates password vulnerabilities. When agents communicate via A2A, scoped tokens ensure proper authorization.</p>
<h2 id="authentication-architecture">Authentication Architecture</h2>
<p>The authentication architecture has three layers, each handling a different concern.</p>
<p><strong>Identity layer</strong>: Determines who is making a request. This layer handles user registration, credential verification, and session management. WebAuthn provides the primary authentication mechanism for interactive users.</p>
<p><strong>Authorization layer</strong>: Determines what a requester can do. OAuth2 scopes define permissions. Every API endpoint, MCP tool, and agent capability is protected by scope requirements. The <code>systemprompt-security</code> crate implements token generation, validation, and introspection.</p>
<p><strong>Audit layer</strong>: Records what actually happened. Every authentication event, token issuance, and authorization decision is logged with trace IDs. This creates a complete audit trail for compliance and debugging.</p>
<p>The <code>systemprompt-oauth</code> crate implements the OAuth2 authorization server. It supports authorization code flow with PKCE for web applications, client credentials flow for service-to-service communication, and token introspection for resource servers.</p>
<h2 id="oauth2-authorization-flows">OAuth2 Authorization Flows</h2>
<p>SystemPrompt implements OAuth2 as the authorization framework for all API access. The authorization server exposes standard endpoints that work with any OAuth2 client.</p>
<p><strong>Authorization endpoints:</strong></p>
<table>
<thead>
<tr>
<th>Endpoint</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/api/v1/core/oauth/authorize</code></td>
<td>Authorization request</td>
</tr>
<tr>
<td><code>/api/v1/core/oauth/token</code></td>
<td>Token exchange</td>
</tr>
<tr>
<td><code>/api/v1/core/oauth/introspect</code></td>
<td>Token introspection</td>
</tr>
<tr>
<td><code>/.well-known/openid-configuration</code></td>
<td>OIDC discovery</td>
</tr>
</tbody>
</table>
<p><strong>Authorization code flow with PKCE:</strong></p>
<p>The recommended flow for web applications and native apps. PKCE (Proof Key for Code Exchange) prevents authorization code interception attacks.</p>
<ol>
<li>Client generates a code verifier and challenge</li>
<li>User is redirected to authorization endpoint with challenge</li>
<li>User authenticates and grants consent</li>
<li>Authorization server redirects back with authorization code</li>
<li>Client exchanges code + verifier for access token</li>
</ol>
<pre><code class="language-yaml"># Agent OAuth2 configuration
securitySchemes:
  oauth2:
    type: oauth2
    flows:
      authorizationCode:
        authorizationUrl: &quot;/api/v1/core/oauth/authorize&quot;
        tokenUrl: &quot;/api/v1/core/oauth/token&quot;
        scopes:
          anonymous: &quot;Public access without authentication&quot;
          user: &quot;Authenticated user access&quot;
          admin: &quot;Administrative operations&quot;
</code></pre>
<p><strong>Client credentials flow:</strong></p>
<p>For service-to-service authentication where no user is involved. The MCP server uses this flow when executing commands on behalf of the system.</p>
<pre><code class="language-bash"># Obtain service token
curl -X POST /api/v1/core/oauth/token \
  -d &quot;grant_type=client_credentials&quot; \
  -d &quot;client_id=mcp-server&quot; \
  -d &quot;client_secret=${CLIENT_SECRET}&quot; \
  -d &quot;scope=admin&quot;
</code></pre>
<p><strong>Token structure:</strong></p>
<p>Access tokens are JWTs containing claims about the authenticated principal and granted scopes. The token includes:</p>
<ul>
<li><code>sub</code>: Subject identifier (user ID or client ID)</li>
<li><code>scope</code>: Space-separated list of granted scopes</li>
<li><code>aud</code>: Intended audience (e.g., &quot;mcp&quot;, &quot;api&quot;)</li>
<li><code>exp</code>: Expiration timestamp</li>
<li><code>tenant_id</code>: Multi-tenant isolation identifier</li>
</ul>
<h2 id="webauthn-passwordless-authentication">WebAuthn Passwordless Authentication</h2>
<p>WebAuthn eliminates passwords entirely. Users authenticate with biometrics (Face ID, Touch ID, Windows Hello) or hardware security keys (YubiKey). This provides phishing-resistant authentication that cannot be stolen or guessed.</p>
<p><strong>Registration flow:</strong></p>
<ol>
<li>User initiates registration</li>
<li>Server generates a challenge</li>
<li>User's authenticator creates a credential</li>
<li>Public key is stored server-side</li>
<li>Private key never leaves the authenticator</li>
</ol>
<p><strong>Authentication flow:</strong></p>
<ol>
<li>User initiates login</li>
<li>Server sends challenge with allowed credentials</li>
<li>Authenticator signs challenge with private key</li>
<li>Server verifies signature with stored public key</li>
<li>Session is established</li>
</ol>
<p>WebAuthn credentials are bound to the origin (domain), preventing phishing attacks. Even if a user is tricked into visiting a fake site, the authenticator will refuse to respond because the origin doesn't match.</p>
<p>The CLI uses device-bound credentials for authentication:</p>
<pre><code class="language-bash"># Initiate WebAuthn login
systemprompt cloud auth login

# This opens a browser for biometric verification
# No password is ever transmitted
</code></pre>
<h2 id="scopes-for-fine-grained-access-control">Scopes for Fine-Grained Access Control</h2>
<p>Scopes are the unit of permission in SystemPrompt. Every protected operation requires specific scopes. Users and applications receive tokens with only the scopes they need.</p>
<p><strong>Common scopes:</strong></p>
<table>
<thead>
<tr>
<th>Scope</th>
<th>Permission</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>anonymous</code></td>
<td>Public access, no authentication required</td>
</tr>
<tr>
<td><code>user</code></td>
<td>Basic authenticated user operations</td>
</tr>
<tr>
<td><code>admin</code></td>
<td>Administrative operations</td>
</tr>
<tr>
<td><code>tools:read</code></td>
<td>Read MCP tool definitions</td>
</tr>
<tr>
<td><code>tools:execute</code></td>
<td>Execute MCP tools</td>
</tr>
<tr>
<td><code>agents:read</code></td>
<td>View agent configurations</td>
</tr>
<tr>
<td><code>agents:write</code></td>
<td>Modify agent configurations</td>
</tr>
</tbody>
</table>
<p><strong>Scope enforcement:</strong></p>
<p>Scopes are checked at multiple levels. API routes declare required scopes in their handlers. MCP tools specify scope requirements in their manifests. Agents define which scopes are needed to interact with them.</p>
<pre><code class="language-yaml"># MCP server OAuth configuration
oauth:
  required: true
  scopes: [&quot;admin&quot;]
  audience: &quot;mcp&quot;
</code></pre>
<p>When a request arrives, the authorization layer extracts scopes from the access token and compares them against the operation's requirements. If the token lacks required scopes, the request is rejected with a 403 Forbidden response.</p>
<p><strong>Scope hierarchies:</strong></p>
<p>Some scopes imply others. The <code>admin</code> scope typically includes all lesser scopes. This is configured in the authorization server and simplifies token management for privileged users.</p>
<h2 id="configuration">Configuration</h2>
<p>Authentication settings are distributed across profile configuration and service-specific YAML files.</p>
<p><strong>Profile security settings:</strong></p>
<pre><code class="language-yaml"># .systemprompt/profiles/local/profile.yaml
security:
  auth_secret: ${AUTH_SECRET}
  encryption_key: ${ENCRYPTION_KEY}
  token_expiry_seconds: 3600
</code></pre>
<p><strong>Agent security schemes:</strong></p>
<pre><code class="language-yaml"># services/agents/welcome.yaml
securitySchemes:
  oauth2:
    type: oauth2
    flows:
      authorizationCode:
        authorizationUrl: &quot;/api/v1/core/oauth/authorize&quot;
        tokenUrl: &quot;/api/v1/core/oauth/token&quot;
        scopes:
          anonymous: &quot;Public access&quot;
          user: &quot;Authenticated access&quot;
          admin: &quot;Administrative access&quot;

security:
  - oauth2: [&quot;anonymous&quot;]  # Minimum required scopes
</code></pre>
<h2 id="cli-authentication-commands">CLI Authentication Commands</h2>
<pre><code class="language-bash"># Login to SystemPrompt Cloud
systemprompt cloud auth login

# Check current session
systemprompt admin session show

# Refresh access token
systemprompt admin session refresh

# Logout and clear credentials
systemprompt cloud auth logout
</code></pre>
<h2 id="cli-reference">CLI Reference</h2>
<p>Authentication is managed through cloud auth and session commands.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>systemprompt cloud auth login</code></td>
<td>Authenticate with SystemPrompt Cloud via OAuth</td>
</tr>
<tr>
<td><code>systemprompt cloud auth logout</code></td>
<td>Clear saved cloud credentials</td>
</tr>
<tr>
<td><code>systemprompt cloud auth whoami</code></td>
<td>Show current authenticated user and token status</td>
</tr>
<tr>
<td><code>systemprompt admin session show</code></td>
<td>Show current session and routing info</td>
</tr>
<tr>
<td><code>systemprompt admin session switch</code></td>
<td>Switch to a different profile</td>
</tr>
<tr>
<td><code>systemprompt admin session list</code></td>
<td>List available profiles</td>
</tr>
<tr>
<td><code>systemprompt admin session login</code></td>
<td>Create an admin session for CLI access</td>
</tr>
<tr>
<td><code>systemprompt admin session logout</code></td>
<td>Remove a session</td>
</tr>
</tbody>
</table>
<p>See <code>systemprompt cloud auth --help</code> and <code>systemprompt admin session --help</code> for detailed options.</p>
<h2 id="security-considerations">Security Considerations</h2>
<p>Several security properties are enforced by default:</p>
<ul>
<li><strong>TLS required</strong>: All production traffic must use HTTPS</li>
<li><strong>Token rotation</strong>: Access tokens have short lifetimes</li>
<li><strong>Credential isolation</strong>: Credentials are never logged or exposed in errors</li>
<li><strong>Tenant boundaries</strong>: Tokens are scoped to specific tenants</li>
<li><strong>Audit logging</strong>: All authentication events are recorded</li>
</ul>

        </div>

      </article>
    </main>

    <!-- Right Sidebar - Table of Contents & Related Links -->
    <aside class="docs-toc">
      <nav class="toc-nav" aria-label="Table of contents">
        <h3 class="toc-title">On this page</h3>
        <div class="toc-content">
          <ul class="toc-list">
<li class="toc-item toc-level-2">
<a class="toc-link" href="#authentication-architecture">Authentication Architecture</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#oauth2-authorization-flows">OAuth2 Authorization Flows</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#webauthn-passwordless-authentication">WebAuthn Passwordless Authentication</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#scopes-for-fine-grained-access-control">Scopes for Fine-Grained Access Control</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#configuration">Configuration</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#cli-authentication-commands">CLI Authentication Commands</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#cli-reference">CLI Reference</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#security-considerations">Security Considerations</a>
</li>
</ul>

        </div>
      </nav>


    </aside>
  </div>

  <footer class="site-footer">
  <div class="container">
    <div class="footer-grid">
      <div class="footer-brand">
        <div class="footer-logo">
          <img src="/files/images/logo.svg" alt="systemprompt.io" class="logo-svg" />
        </div>
        <p></p>
      </div>
      <div class="footer-links">
        <h4>Product</h4>
        <a href="/documentation">Documentation</a>
        <a href="/blog">Blog</a>
        <a href="/playbooks">Playbooks</a>
        <a href="https://github.com/systempromptio/systemprompt-template">Get Started</a>
        <a href="/sitemap.xml">Sitemap</a>
        <a href="/llms.txt">llms.txt</a>
      </div>
      <div class="footer-links">
        <h4>Features</h4>
        <a href="/features/agentic-mesh">Agentic Mesh</a>
        <a href="/features/self-hosted-ai-platform">Embedded AI Library</a>
        <a href="/features/unified-control-plane">Unified Control Plane</a>
        <a href="/features/closed-loop-agents">The Closed Loop</a>
      </div>
      <div class="footer-links">
        <h4>Legal</h4>
        <a href="/legal/privacy-policy">Privacy Policy</a>
        <a href="/legal/cookie-policy">Cookie Policy</a>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2025 Your Company. All rights reserved.</p>
    </div>
  </div>
</footer>


  <!-- Scripts -->
  <script src="/js/docs.js"></script>
  <!-- Analytics -->
<script src="/files/js/analytics.js" defer></script>
<!-- Mobile Menu Toggle -->
<script src="/js/mobile-menu.js" defer></script>

</body>
</html>
