<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Resource Hints -->
<link rel="preconnect" href="/files/fonts/" crossorigin>
<link rel="dns-prefetch" href="/files/fonts/">

<!-- Font Preloading - Critical fonts loaded early -->
<link rel="preload" as="font" href="/files/fonts/Zepto/Zepto.woff" type="font/woff" crossorigin>
<link rel="preload" as="font" href="/files/fonts/OpenSans/OpenSans-Regular.ttf" type="font/truetype" crossorigin>

<!-- Critical CSS - Inlined to prevent FOUC -->
<style>
/* Prevent flash of unstyled content */
:root {
  --color-bg: #0a0a0f;
  --color-surface: #12121a;
  --color-text: #e8e8ed;
  --color-text-secondary: #9898a6;
  --orange-500: #f97316;
  --orange-600: #ea580c;
}
html {
  background-color: var(--color-bg);
  color: var(--color-text);
}
body {
  margin: 0;
  font-family: "OpenSans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  background-color: var(--color-bg);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* Hide content until styles load to prevent layout shift */
.header, .site-header {
  min-height: 64px;
}
/* Font-face for immediate availability */
@font-face {
  font-family: "Zepto";
  src: url("/files/fonts/Zepto/Zepto.woff") format("woff");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: "OpenSans";
  src: url("/files/fonts/OpenSans/OpenSans-Regular.ttf") format("truetype");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}
</style>

<!-- Core Styles -->
<link rel="stylesheet" href="/css/core/variables.css">
<link rel="stylesheet" href="/css/core/fonts.css">
<link rel="stylesheet" href="/css/core/reset.css">
<link rel="stylesheet" href="/css/components/header.css">
<link rel="stylesheet" href="/css/components/footer.css">
<link rel="stylesheet" href="/css/components/mobile-menu.css">


  <!-- SEO Meta Tags -->
  <title>Analytics | systemprompt.io Documentation</title>
  <meta name="description" content="Costs, usage, audit trails. Every AI request logged automatically with full observability." />
  <meta name="author" content="SystemPrompt Team" />
  <meta name="keywords" content="analytics, costs, usage, audit, tracking, metrics" />
  <link rel="canonical" href="https://systemprompt.io/documentation/services/analytics" />

  <!-- Open Graph -->
  <meta property="og:title" content="Analytics" />
  <meta property="og:description" content="Costs, usage, audit trails. Every AI request logged automatically with full observability." />
  <meta property="og:image" content="/files/images/docs/services-analytics.svg" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://systemprompt.io/documentation/services/analytics" />
  <meta property="og:site_name" content="systemprompt.io" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@your_handle" />
  <meta name="twitter:creator" content="@your_handle" />
  <meta name="twitter:title" content="Analytics" />
  <meta name="twitter:description" content="Costs, usage, audit trails. Every AI request logged automatically with full observability." />
  <meta name="twitter:image" content="/files/images/docs/services-analytics.svg" />

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />

  <!-- Styles -->
  <link rel="stylesheet" href="/css/docs.css" />
  <link rel="stylesheet" href="/css/syntax-highlight.css" />

  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "TechArticle",
    "headline": "Analytics",
    "description": "Costs, usage, audit trails. Every AI request logged automatically with full observability.",
    "image": "/files/images/docs/services-analytics.svg",
    "author": {
      "@type": "Organization",
      "name": "systemprompt.io"
    },
    "publisher": {
      "@type": "Organization",
      "name": "systemprompt.io",
      "logo": {
        "@type": "ImageObject",
        "url": "https://systemprompt.io/files/images/logo.png"
      }
    },
    "datePublished": "",
    "dateModified": "",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://systemprompt.io/documentation/services/analytics"
    },
    "keywords": "analytics, costs, usage, audit, tracking, metrics",
    "inLanguage": ""
  }
  </script>

  <!-- BreadcrumbList Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {"@type": "ListItem", "position": 1, "name": "Home", "item": "https://systemprompt.io"},
      {"@type": "ListItem", "position": 2, "name": "Documentation", "item": "https://systemprompt.io/documentation"},
      {"@type": "ListItem", "position": 3, "name": "Analytics", "item": "https://systemprompt.io/documentation/services/analytics"}
    ]
  }
  </script>
</head>
<body class="docs-body">
  <div class="docs-background"></div>

  <header class="site-header">
  <nav class="site-nav">
    <a href="/" class="logo-link">
      <img src="/files/images/logo.svg" alt="systemprompt.io" class="logo-svg" />
    </a>
    <button class="mobile-menu-toggle" aria-label="Toggle navigation" aria-expanded="false">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    <div class="nav-links">
      <div class="nav-dropdown">
        <a href="/documentation" class="nav-dropdown-trigger">
          Documentation
          <svg class="dropdown-arrow" viewBox="0 0 12 12" width="12" height="12">
            <path d="M2 4l4 4 4-4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </a>
        <div class="nav-dropdown-menu">
          <div class="dropdown-section">
            <h4>Getting Started</h4>
            <a href="/documentation">Overview</a>
            <a href="/documentation/installation">Installation</a>
            <a href="/documentation/playbooks">Playbooks</a>
          </div>
          <div class="dropdown-section">
            <h4>Configuration</h4>
            <a href="/documentation/config">Config</a>
            <a href="/documentation/services">Services</a>
            <a href="/documentation/extensions">Extensions</a>
          </div>
          <a href="/documentation" class="dropdown-view-all">View all documentation &rarr;</a>
        </div>
      </div>
      <div class="nav-dropdown">
        <a href="/blog" class="nav-dropdown-trigger">
          Blog
          <svg class="dropdown-arrow" viewBox="0 0 12 12" width="12" height="12">
            <path d="M2 4l4 4 4-4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </a>
        <div class="nav-dropdown-menu">
          <div class="dropdown-section">
            <h4>Categories</h4>
            <a href="/blog">All Posts</a>
            <a href="/blog?category&#x3D;announcement">Announcements</a>
            <a href="/blog?category&#x3D;article">Articles</a>
            <a href="/blog?category&#x3D;guide">Guides</a>
          </div>
        </div>
      </div>
      <div class="nav-dropdown">
        <a href="/playbooks" class="nav-dropdown-trigger">
          Playbooks
          <svg class="dropdown-arrow" viewBox="0 0 12 12" width="12" height="12">
            <path d="M2 4l4 4 4-4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </a>
        <div class="nav-dropdown-menu">
          <div class="dropdown-section">
            <h4>Categories</h4>
            <a href="/playbooks">All Playbooks</a>
            <a href="/playbooks?category&#x3D;guide">Guides</a>
            <a href="/playbooks?category&#x3D;cli">CLI</a>
            <a href="/playbooks?category&#x3D;build">Build</a>
            <a href="/playbooks?category&#x3D;content">Content</a>
          </div>
        </div>
      </div>
      <a href="/documentation/installation" class="cta-button">Get Started</a>
    </div>
  </nav>
</header>


  <div class="docs-layout">
    <!-- Left Sidebar - Navigation (dynamically rendered from config.yaml) -->
    <aside class="docs-sidebar">
      <nav class="docs-nav" aria-label="Documentation navigation">
        <div class="docs-nav-section">
          <h3 class="docs-nav-title">Getting Started</h3>
          <ul class="docs-nav-list">
            <li><a href="/documentation" class="docs-nav-link">Overview</a></li>
            <li><a href="/documentation/installation" class="docs-nav-link">Installation</a></li>
            <li><a href="/documentation/licensing" class="docs-nav-link">Licensing</a></li>
            <li><a href="/documentation/playbooks" class="docs-nav-link">Playbooks</a></li>
          </ul>
        </div>
        <div class="docs-nav-section">
          <h3 class="docs-nav-title">Config</h3>
          <ul class="docs-nav-list">
            <li><a href="/documentation/config" class="docs-nav-link">Overview</a></li>
            <li><a href="/documentation/config/database" class="docs-nav-link">Database</a></li>
            <li><a href="/documentation/config/deployment" class="docs-nav-link">Deployment</a></li>
            <li><a href="/documentation/config/docker" class="docs-nav-link">Docker</a></li>
            <li><a href="/documentation/config/domains" class="docs-nav-link">Domains</a></li>
            <li><a href="/documentation/config/profiles" class="docs-nav-link">Profiles</a></li>
            <li><a href="/documentation/config/secrets" class="docs-nav-link">Secrets</a></li>
            <li><a href="/documentation/config/sessions" class="docs-nav-link">Sessions</a></li>
            <li><a href="/documentation/config/sync" class="docs-nav-link">Sync</a></li>
            <li><a href="/documentation/config/tenants" class="docs-nav-link">Tenants</a></li>
          </ul>
        </div>
        <div class="docs-nav-section">
          <h3 class="docs-nav-title">Services</h3>
          <ul class="docs-nav-list">
            <li><a href="/documentation/services" class="docs-nav-link">Overview</a></li>
            <li><a href="/documentation/services/agents" class="docs-nav-link">Agents</a></li>
            <li><a href="/documentation/services/ai" class="docs-nav-link">AI</a></li>
            <li><a href="/documentation/services/analytics" class="docs-nav-link">Analytics</a></li>
            <li><a href="/documentation/services/auth" class="docs-nav-link">Auth</a></li>
            <li><a href="/documentation/services/config" class="docs-nav-link">Config</a></li>
            <li><a href="/documentation/services/content" class="docs-nav-link">Content</a></li>
            <li><a href="/documentation/services/files" class="docs-nav-link">Files</a></li>
            <li><a href="/documentation/services/mcp" class="docs-nav-link">MCP</a></li>
            <li><a href="/documentation/services/playbooks" class="docs-nav-link">Playbooks</a></li>
            <li><a href="/documentation/services/scheduler" class="docs-nav-link">Scheduler</a></li>
            <li><a href="/documentation/services/skills" class="docs-nav-link">Skills</a></li>
            <li><a href="/documentation/services/users" class="docs-nav-link">Users</a></li>
            <li><a href="/documentation/services/web" class="docs-nav-link">Web</a></li>
            <li><a href="/documentation/services/workflows" class="docs-nav-link">Workflows</a></li>
          </ul>
        </div>
        <div class="docs-nav-section">
          <h3 class="docs-nav-title">Extensions</h3>
          <ul class="docs-nav-list">
            <li><a href="/documentation/extensions" class="docs-nav-link">Overview</a></li>
            <li><a href="/documentation/extensions/template" class="docs-nav-link">Template Architecture</a></li>
            <li><a href="/documentation/extensions/hooks" class="docs-nav-link">Lifecycle Hooks</a></li>
            <li><a href="/documentation/extensions/rust" class="docs-nav-link">Library Extensions</a></li>
            <li><a href="/documentation/extensions/web" class="docs-nav-link">Web Extensions</a></li>
            <li><a href="/documentation/extensions/page-data-providers" class="docs-nav-link">Page Data Providers</a></li>
            <li><a href="/documentation/extensions/component-renderers" class="docs-nav-link">Component Renderers</a></li>
            <li><a href="/documentation/extensions/jobs" class="docs-nav-link">Background Jobs</a></li>
            <li><a href="/documentation/extensions/mcp" class="docs-nav-link">MCP Extensions</a></li>
            <li><a href="/documentation/extensions/cli" class="docs-nav-link">CLI Extensions</a></li>
          </ul>
        </div>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="docs-main">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="/">Home</a>
        <span class="breadcrumb__separator">/</span>
        <a href="/documentation">Documentation</a>
        <span class="breadcrumb__separator">/</span>
        <span class="breadcrumb__current">Analytics</span>
      </nav>

      <article class="docs-article">
        <header class="docs-header">
          <div class="docs-title-row">
            <h1>Analytics</h1>
            <button class="docs-export-btn" data-slug="services/analytics" aria-label="Copy as Markdown" title="Copy as Markdown">
              <svg class="copy-icon" viewBox="0 0 16 16" width="16" height="16" fill="currentColor">
                <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"/>
                <path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"/>
              </svg>
              <svg class="check-icon" viewBox="0 0 16 16" width="16" height="16" fill="currentColor">
                <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.75.75 0 1 1 1.06-1.06L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"/>
              </svg>
            </button>
          </div>
          <p class="docs-description">Costs, usage, audit trails. Every AI request logged automatically with full observability.</p>
          <div class="docs-meta">
            <time datetime="">Last updated: </time>
          </div>
        </header>

        <!-- Learning Objectives - Top Callout -->

        <!-- Mobile Table of Contents (shown ≤1200px) -->
        <div class="docs-toc-mobile">
          <details class="toc-mobile-details">
            <summary class="toc-mobile-summary">
              <span class="toc-mobile-label">On this page</span>
              <svg class="toc-mobile-chevron" viewBox="0 0 12 12" width="12" height="12" fill="none" stroke="currentColor">
                <path d="M2 4l4 4 4-4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </summary>
            <nav class="toc-mobile-nav" aria-label="Table of contents">
              <div class="toc-content toc-content--mobile">
                <ul class="toc-list">
<li class="toc-item toc-level-2">
<a class="toc-link" href="#analytics-architecture">Analytics Architecture</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#track-ai-costs">Track AI Costs</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#query-usage-metrics">Query Usage Metrics</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#audit-trails">Audit Trails</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#agent-self-analysis">Agent Self-Analysis</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#dashboard-integration">Dashboard Integration</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#configuration">Configuration</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#configuration-reference">Configuration Reference</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#cli-reference">CLI Reference</a>
</li>
</ul>

              </div>


            </nav>
          </details>
        </div>

        <div class="docs-content">
          <p>SystemPrompt logs every AI request automatically. Token counts, costs, latencies, error rates—all captured without instrumentation code. The analytics system provides observability into your AI operations, enabling cost management, performance optimization, and compliance auditing.</p>
<p>The analytics architecture follows the &quot;closed loop&quot; principle. Agents can query their own performance data through the same interface that humans use. An agent can ask &quot;what was my average response time today?&quot; and receive actionable data. This self-awareness enables adaptive behavior.</p>
<h2 id="analytics-architecture">Analytics Architecture</h2>
<p>The analytics system captures data at multiple points in the request lifecycle, stores it efficiently, and provides query interfaces for both real-time and historical analysis.</p>
<p><strong>Data capture:</strong></p>
<p>Every AI request flows through instrumented middleware. The middleware captures timing, token counts, and metadata before and after LLM calls. This happens transparently—no application code changes required.</p>
<pre><code>Request → Middleware (start timer) → LLM Call → Middleware (capture metrics) → Response
                                         ↓
                                   Analytics Store
</code></pre>
<p><strong>Storage:</strong></p>
<p>Analytics data is stored in PostgreSQL alongside application data. Time-series data uses partitioned tables for efficient querying of recent data while maintaining historical archives. The <code>systemprompt-analytics</code> crate manages schema and queries.</p>
<p><strong>Query interfaces:</strong></p>
<ul>
<li><strong>CLI</strong>: Direct queries for operators and scripts</li>
<li><strong>API</strong>: Programmatic access for dashboards</li>
<li><strong>MCP</strong>: Agent access for self-analysis</li>
</ul>
<h2 id="track-ai-costs">Track AI Costs</h2>
<p>Cost tracking is automatic for all supported providers. The system knows token pricing for each model and calculates costs in real-time.</p>
<p><strong>Supported providers:</strong></p>
<table>
<thead>
<tr>
<th>Provider</th>
<th>Models</th>
<th>Cost Tracking</th>
</tr>
</thead>
<tbody>
<tr>
<td>Anthropic</td>
<td>Claude Opus, Sonnet, Haiku</td>
<td>Full support</td>
</tr>
<tr>
<td>OpenAI</td>
<td>GPT-4, GPT-3.5</td>
<td>Full support</td>
</tr>
<tr>
<td>Gemini</td>
<td>Gemini Pro, Flash</td>
<td>Full support</td>
</tr>
</tbody>
</table>
<p><strong>Cost calculation:</strong></p>
<p>Costs are calculated from token counts and model-specific pricing:</p>
<pre><code>Cost = (input_tokens × input_price) + (output_tokens × output_price)
</code></pre>
<p>Pricing tables are updated regularly. For custom or fine-tuned models, you can configure custom pricing.</p>
<p><strong>CLI cost queries:</strong></p>
<pre><code class="language-bash"># View costs for today
systemprompt analytics costs --period today

# View costs by provider
systemprompt analytics costs --group-by provider --period week

# View costs by model
systemprompt analytics costs --group-by model --period month

# View costs by agent
systemprompt analytics costs --group-by agent --period week
</code></pre>
<p><strong>Example output:</strong></p>
<pre><code>Period: 2026-01-24 to 2026-01-30

Provider     | Requests | Input Tokens | Output Tokens | Cost
-------------|----------|--------------|---------------|--------
anthropic    | 1,247    | 2.4M         | 890K          | $42.15
openai       | 156      | 180K         | 45K           | $3.80
gemini       | 892      | 1.1M         | 320K          | $8.40
-------------|----------|--------------|---------------|--------
Total        | 2,295    | 3.68M        | 1.26M         | $54.35
</code></pre>
<p><strong>Budget alerts:</strong></p>
<p>Configure alerts when spending approaches thresholds:</p>
<pre><code class="language-yaml"># Profile configuration
analytics:
  alerts:
    - type: daily_cost
      threshold: 100.00
      action: email
    - type: monthly_cost
      threshold: 1000.00
      action: pause_requests
</code></pre>
<h2 id="query-usage-metrics">Query Usage Metrics</h2>
<p>Beyond costs, the analytics system tracks operational metrics that help optimize performance and identify issues.</p>
<p><strong>Available metrics:</strong></p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>request_count</code></td>
<td>Number of AI requests</td>
</tr>
<tr>
<td><code>token_count</code></td>
<td>Input and output tokens</td>
</tr>
<tr>
<td><code>latency_p50</code></td>
<td>Median response time</td>
</tr>
<tr>
<td><code>latency_p95</code></td>
<td>95th percentile response time</td>
</tr>
<tr>
<td><code>latency_p99</code></td>
<td>99th percentile response time</td>
</tr>
<tr>
<td><code>error_rate</code></td>
<td>Percentage of failed requests</td>
</tr>
<tr>
<td><code>cache_hit_rate</code></td>
<td>Response cache efficiency</td>
</tr>
</tbody>
</table>
<p><strong>CLI usage queries:</strong></p>
<pre><code class="language-bash"># Request volume over time
systemprompt analytics requests --period week --interval day

# Latency percentiles
systemprompt analytics latency --period day --percentiles 50,95,99

# Error analysis
systemprompt analytics errors --period week --group-by error_type

# Traffic by hour
systemprompt analytics traffic --period day --interval hour
</code></pre>
<p><strong>Filtering:</strong></p>
<p>Queries can be filtered by various dimensions:</p>
<pre><code class="language-bash"># Filter by agent
systemprompt analytics requests --agent welcome --period week

# Filter by user
systemprompt analytics requests --user user_abc123 --period day

# Filter by model
systemprompt analytics requests --model claude-sonnet-4 --period month
</code></pre>
<h2 id="audit-trails">Audit Trails</h2>
<p>Every operation in SystemPrompt generates audit events. These events create a complete record of who did what, when, and how.</p>
<p><strong>Audit event types:</strong></p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Events</th>
</tr>
</thead>
<tbody>
<tr>
<td>Authentication</td>
<td>login, logout, token_issued, token_revoked</td>
</tr>
<tr>
<td>Authorization</td>
<td>scope_granted, permission_denied</td>
</tr>
<tr>
<td>AI Operations</td>
<td>request_started, request_completed, request_failed</td>
</tr>
<tr>
<td>Data Access</td>
<td>file_accessed, content_created, content_deleted</td>
</tr>
<tr>
<td>Administration</td>
<td>user_created, config_changed, agent_modified</td>
</tr>
</tbody>
</table>
<p><strong>Audit event structure:</strong></p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;evt_abc123&quot;,
  &quot;timestamp&quot;: &quot;2026-01-30T14:23:45Z&quot;,
  &quot;tenant_id&quot;: &quot;tenant_xyz&quot;,
  &quot;user_id&quot;: &quot;user_123&quot;,
  &quot;event_type&quot;: &quot;ai.request_completed&quot;,
  &quot;trace_id&quot;: &quot;trace_789&quot;,
  &quot;metadata&quot;: {
    &quot;provider&quot;: &quot;anthropic&quot;,
    &quot;model&quot;: &quot;claude-sonnet-4&quot;,
    &quot;input_tokens&quot;: 1250,
    &quot;output_tokens&quot;: 480,
    &quot;latency_ms&quot;: 2340
  }
}
</code></pre>
<p><strong>Querying audit events:</strong></p>
<pre><code class="language-bash"># View recent audit events
systemprompt analytics audit --limit 100

# Filter by event type
systemprompt analytics audit --type &quot;ai.*&quot; --period day

# Filter by user
systemprompt analytics audit --user user_123 --period week

# Export for compliance
systemprompt analytics audit --period month --format json &gt; audit.json
</code></pre>
<p><strong>Trace correlation:</strong></p>
<p>Every request receives a trace ID that links all related events. You can follow a single user action through authentication, authorization, AI calls, and responses.</p>
<pre><code class="language-bash"># Follow a trace
systemprompt analytics trace &lt;trace_id&gt;

# Output shows all events with this trace ID in chronological order
</code></pre>
<h2 id="agent-self-analysis">Agent Self-Analysis</h2>
<p>The closed-loop architecture enables agents to query their own analytics. An agent can assess its performance, identify patterns, and adapt behavior.</p>
<p><strong>MCP analytics tools:</strong></p>
<p>When connected via MCP, agents have access to analytics queries:</p>
<ul>
<li><code>analytics_costs</code>: Query cost data</li>
<li><code>analytics_requests</code>: Query request metrics</li>
<li><code>analytics_errors</code>: Query error patterns</li>
<li><code>analytics_audit</code>: Query audit events</li>
</ul>
<p><strong>Self-analysis patterns:</strong></p>
<p>An agent might ask:</p>
<ul>
<li>&quot;What was my average response time in the last hour?&quot;</li>
<li>&quot;Which of my responses had the highest token counts?&quot;</li>
<li>&quot;How many errors did I encounter today?&quot;</li>
</ul>
<p>This data enables agents to optimize their behavior. An agent noticing high latency might switch to a faster model. An agent seeing repeated errors might adjust its approach.</p>
<h2 id="dashboard-integration">Dashboard Integration</h2>
<p>Analytics data is available through the API for custom dashboards and integrations.</p>
<p><strong>API endpoints:</strong></p>
<table>
<thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/api/v1/analytics/costs</code></td>
<td>Cost metrics</td>
</tr>
<tr>
<td><code>/api/v1/analytics/requests</code></td>
<td>Request metrics</td>
</tr>
<tr>
<td><code>/api/v1/analytics/latency</code></td>
<td>Latency percentiles</td>
</tr>
<tr>
<td><code>/api/v1/analytics/audit</code></td>
<td>Audit events</td>
</tr>
</tbody>
</table>
<p><strong>Response format:</strong></p>
<pre><code class="language-json">{
  &quot;period&quot;: {
    &quot;start&quot;: &quot;2026-01-24T00:00:00Z&quot;,
    &quot;end&quot;: &quot;2026-01-30T23:59:59Z&quot;
  },
  &quot;data&quot;: [
    {
      &quot;timestamp&quot;: &quot;2026-01-24&quot;,
      &quot;requests&quot;: 342,
      &quot;cost&quot;: 7.84,
      &quot;latency_p50&quot;: 1240
    }
  ]
}
</code></pre>
<h2 id="configuration">Configuration</h2>
<p>Analytics configuration is in the profile settings:</p>
<pre><code class="language-yaml"># Profile configuration
analytics:
  enabled: true
  retention_days: 90
  sampling_rate: 1.0  # 100% sampling

  costs:
    currency: USD
    custom_pricing:
      my-custom-model:
        input_per_1k: 0.01
        output_per_1k: 0.03

  alerts:
    - type: daily_cost
      threshold: 100.00
      action: email
</code></pre>
<h2 id="configuration-reference">Configuration Reference</h2>
<table>
<thead>
<tr>
<th>Item</th>
<th>Location</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Enable analytics</td>
<td>Profile (<code>analytics.enabled</code>)</td>
<td>Turn analytics on/off</td>
</tr>
<tr>
<td>Retention</td>
<td>Profile (<code>analytics.retention_days</code>)</td>
<td>How long to keep data</td>
</tr>
<tr>
<td>Sampling</td>
<td>Profile (<code>analytics.sampling_rate</code>)</td>
<td>Percentage of requests to track</td>
</tr>
<tr>
<td>Custom pricing</td>
<td>Profile (<code>analytics.costs.custom_pricing</code>)</td>
<td>Model-specific costs</td>
</tr>
<tr>
<td>Alerts</td>
<td>Profile (<code>analytics.alerts</code>)</td>
<td>Budget notifications</td>
</tr>
</tbody>
</table>
<h2 id="cli-reference">CLI Reference</h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>systemprompt analytics overview</code></td>
<td>Dashboard overview of all analytics</td>
</tr>
<tr>
<td><code>systemprompt analytics conversations</code></td>
<td>Conversation analytics</td>
</tr>
<tr>
<td><code>systemprompt analytics agents</code></td>
<td>Agent performance analytics</td>
</tr>
<tr>
<td><code>systemprompt analytics tools</code></td>
<td>Tool usage analytics</td>
</tr>
<tr>
<td><code>systemprompt analytics requests</code></td>
<td>AI request analytics</td>
</tr>
<tr>
<td><code>systemprompt analytics sessions</code></td>
<td>Session analytics</td>
</tr>
<tr>
<td><code>systemprompt analytics content</code></td>
<td>Content performance analytics</td>
</tr>
<tr>
<td><code>systemprompt analytics traffic</code></td>
<td>Traffic analytics</td>
</tr>
<tr>
<td><code>systemprompt analytics costs</code></td>
<td>Cost analytics</td>
</tr>
</tbody>
</table>
<p>See <code>systemprompt analytics &lt;command&gt; --help</code> for detailed options.</p>

        </div>

      </article>
    </main>

    <!-- Right Sidebar - Table of Contents & Related Links -->
    <aside class="docs-toc">
      <nav class="toc-nav" aria-label="Table of contents">
        <h3 class="toc-title">On this page</h3>
        <div class="toc-content">
          <ul class="toc-list">
<li class="toc-item toc-level-2">
<a class="toc-link" href="#analytics-architecture">Analytics Architecture</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#track-ai-costs">Track AI Costs</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#query-usage-metrics">Query Usage Metrics</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#audit-trails">Audit Trails</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#agent-self-analysis">Agent Self-Analysis</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#dashboard-integration">Dashboard Integration</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#configuration">Configuration</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#configuration-reference">Configuration Reference</a>
</li>
<li class="toc-item toc-level-2">
<a class="toc-link" href="#cli-reference">CLI Reference</a>
</li>
</ul>

        </div>
      </nav>


    </aside>
  </div>

  <footer class="site-footer">
  <div class="container">
    <div class="footer-grid">
      <div class="footer-brand">
        <div class="footer-logo">
          <img src="/files/images/logo.svg" alt="systemprompt.io" class="logo-svg" />
        </div>
        <p></p>
      </div>
      <div class="footer-links">
        <h4>Product</h4>
        <a href="/documentation">Documentation</a>
        <a href="/blog">Blog</a>
        <a href="/playbooks">Playbooks</a>
        <a href="https://github.com/systempromptio/systemprompt-template">Get Started</a>
        <a href="/sitemap.xml">Sitemap</a>
        <a href="/llms.txt">llms.txt</a>
      </div>
      <div class="footer-links">
        <h4>Features</h4>
        <a href="/features/agentic-mesh">Agentic Mesh</a>
        <a href="/features/self-hosted-ai-platform">Embedded AI Library</a>
        <a href="/features/unified-control-plane">Unified Control Plane</a>
        <a href="/features/closed-loop-agents">The Closed Loop</a>
      </div>
      <div class="footer-links">
        <h4>Legal</h4>
        <a href="/legal/privacy-policy">Privacy Policy</a>
        <a href="/legal/cookie-policy">Cookie Policy</a>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2025 Your Company. All rights reserved.</p>
    </div>
  </div>
</footer>


  <!-- Scripts -->
  <script src="/js/docs.js"></script>
  <!-- Analytics -->
<script src="/files/js/analytics.js" defer></script>
<!-- Mobile Menu Toggle -->
<script src="/js/mobile-menu.js" defer></script>

</body>
</html>
